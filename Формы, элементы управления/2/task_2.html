<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
  </head>

  <body>
    <link rel="stylesheet" href="task_2.css" />
    <style>
      textarea {
        resize: none;
      }
      td {
        position: relative;
      }
      button {
        position: absolute;
        z-index: 1;
      }
    </style>

    <p>
      Кликните на ячейку таблицы, чтобы отредактировать её. Нажмите ОК или
      ОТМЕНА, когда закончите.
    </p>

    <table id="table">
      <tr>
        <th colspan="3">
          Квадрат <em>Bagua</em>: Направление, Элемент, Цвет, Значение
        </th>
      </tr>
      <tr>
        <td class="nw">
          <strong>Северо-Запад</strong> <br />Металл <br />Серебро
          <br />Старейшины
        </td>
        <td class="n">
          <strong>Север</strong> <br />Вода <br />Синий <br />Перемены
        </td>
        <td class="ne">
          <strong>Северо-Восток</strong> <br />Земля <br />Жёлтый
          <br />Направление
        </td>
      </tr>
      <tr>
        <td class="w">
          <strong>Запад</strong> <br />Металл <br />Золото <br />Молодость
        </td>
        <td class="c">
          <strong>Центр</strong> <br />Всё <br />Пурпурный <br />Гармония
        </td>
        <td class="e">
          <strong>Восток</strong> <br />Дерево <br />Синий <br />Будущее
        </td>
      </tr>
      <tr>
        <td class="sw">
          <strong>Юго-Запад</strong> <br />Земля <br />Коричневый
          <br />Спокойствие
        </td>
        <td class="s">
          <strong>Юг</strong> <br />Огонь <br />Оранжевый <br />Слава
        </td>
        <td class="se">
          <strong>Юго-Восток</strong> <br />Дерево <br />Зеленый <br />Роман
        </td>
      </tr>
    </table>

    <script>
      table.onclick = (e) => {
        if (e.target.closest("td") && !table.querySelector("textarea")) {
          let cell = e.target;
          let cellContent = cell.innerHTML.trim();
          let editor = document.createElement("textarea");
          let confirmButton = document.createElement("button");
          let cancelButton = document.createElement("button");

          cell.innerHTML = null;

          editor.textContent = cellContent;
          editor.style.width = cell.offsetWidth + "px";
          editor.style.height = cell.offsetHeight + "px";

          confirmButton.textContent = "OK";
          cancelButton.textContent = "CANCEL";

          confirmButton.onclick = () => {
            cellContent = editor.value;
            editor.remove();
            cell.innerHTML = cellContent;
          };

          cancelButton.onclick = () => {
            editor.remove();
            cell.innerHTML = cellContent;
          };

          cell.append(editor);
          cell.append(confirmButton);
          cell.append(cancelButton);

          editor.focus();

          confirmButton.style.bottom = "-" + confirmButton.offsetHeight + "px";
          confirmButton.style.left = 0;

          cancelButton.style.bottom = "-" + confirmButton.offsetHeight + "px";
          cancelButton.style.left = confirmButton.offsetWidth + "px";
        }
      };
    </script>
  </body>
</html>
